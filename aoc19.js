let day19 =  [" |                                                                                                                                                                                                       ", " | +-----------------------------------------+         +-----------------------------------+           +-+ +-+     +---------------------------------------------------------+ +-+           +---+       ", " | |                                         |         |                                   |           | | | |     |                                                         | | |           |   |       ", " | |                                         |   +-----------------------------------------------------|-|-|-------|---------------------------------------------------------+ | |           |   |       ", " | |                                         |   |     |                                   |           | | | |     |                                                           | |           |   |       ", " | |                                         |   |     |                                   +---+       | +-|-----+ | +-----------+             +-+             +---------------|-|-----------+   |       ", " | |                                         |   |     |                                       |       |   | |   | | |           |             | |             |               | |               |       ", " | |                                         |   |     |                         +-------------|-------------------|-|-----------------------------------------+       +-------|-|---------+     |       ", " | |                                         |   |     |                         |             |       |   | |   | | |           |             | |                     |       | |         |     |       ", " | |                                         |   |     |                         +-------------|-------|-------------------------|-----------------------------------------+   | |         |     |       ", " | |                                         |   |     |                                       |       |   | |   | | |           |             | |                     |   |   | |         |     |       ", " | |                 +-----------------------|---------|-----------------------------------------------|---|-----|-|-|-----------|---------------------+   +-------+   |   |   | |   +-----|-+   |       ", " | |                 |                       |   |     |                                       |       |   | |   | | |           |             | |     |   |       |   |   |   | |   |     | |   |       ", " | |                 |                       |   |     |                       +-----------------------|---+ |   | | |           |             | |     |   |     +-|-------|---|-----+     | |   |       ", " | |                 |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |       ", " | |       +---------|-------------------------------------------------------------------------|-------------------|-|-----------|---------------|---------------|---------------|---------------|-----+ ", " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ", " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ", " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ", " | |       |         |                 +-----|---------------------------+     |               | +-----|---------|-|-|---------+ |             | | +---|---|---------------+   | |       +-|-----|---+ | ", " | |       |         |                 |     |   |     |                 |     |               | |     |     |   | | |         | |             | | |   |   |     | |   |       | |       | | |   |   | | ", " | |       |         +-----------------|---------|-----------------------------------------------|-----|-----------|-------------|-------------|---+   |   |     | |   |       | |       | | |   |   | | ", " | |       |                           |     |   |     |                 |     |               | |     |     |   | | |         | |             | |     |   |     | |   |       | |       | | |   |   | | ", " | |       |                           |     |   |     |                 +-----|---------------|-|-----|---------|---+         | |             +-----------|-----------|-------------+   | | |   |   | | ", " | |       |                           |     |   |     |                       |               | |     |     |   | |           | |               |     |   |     | |   |       | |   |   | | |   |   | O ", " | |       |                           |     |   |     |                       |             +-|-------|-----------|-----------|-|-------+       |     |   |     | |   |       | |   |   | | |   |   | | ", " | |       |                           |     |   |     |                       |             | | |     |     |   | |           | |       |       |     |   |     | |   |       | |   |   | | |   |   | | ", " | |       |                           |     |   |     |                       |             | | |     |     |   | |           +-+       |       |     |   |     | |   |       | |   |   | | |   |   | | ", " | |       |                           |     |   |     |                       |             | | |     |     |   | |                     |       |     |   |     | |   |       | |   |   | | |   |   | | ", " | |       |                           |     |   |     |                       |             | | |     | +-------|-|---------------------|---+ +-----+ |   |     | |   |       | |   |   | | |   |   | | ", " | |       |                           |     |   |     |                       |             | | |     | |   |   | |                     |   | | |   | |   |     | |   |       | |   |   | | |   |   | | ", " | +---------+                         |     |   +-----|-----------------------|-------------|-|-------|-|---|-----|-+   +-+ +-+ +-------|-+ | | |   | |   |     | |   |       | |   |   | | |   |   | | ", " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |       | |   |   | | |   |   | | ", " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   +-----|-------|-|-|---|-+ | | ", " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ", " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ", " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ", " |         | |                         +-----|---------------------------------------------------|-----|-----|---|-|K--------|---|-------|-----|-----|-------------|-------|---|-+   |   | | |   | | | | ", " |         | |                               |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   |     |   | | |   | | | | ", " |         | |       +-----------------------|-----------------------------------------------|---|-----|-|-------|---+   | | | | |       | +-----------|---|-----|-|-----+ |   | +---|-+ | | |   | | | | ", " |         | |       |                       |         |                       |             | | |     | |   |   | |     | | | | |       |   | | |   | |   |     | |   | | |   | |   | | | | |   | | | | ", " |         | +-------|---------------------------------|-------------------------------------|---------|-|-------|-|-----------|-|-----+ | +---+ |   | |   |     | |   | | |   | |   | | | | |   | | | | ", " |         |         |                       |         |                       |             | | |     | |   |   | |     | | | | |     | | | |   |   | |   |     | |   | | |   | |   | | | | |   | | | | ", " |         |         |                       | +---------------------------------------------------------|---|---|-------|---|-|-|---------|-|-----+ +-|-----------|---|---|---|-|-------|---------+ | | ", " |         |         |                       | |       |                       |             | | |     | |   |   | |     | | | | |     | | | |   | |   |   |     | |   | | |   | |   | | | | |   |   | | ", " |         |         |                 +-+   | |       | +---------------------------------------|-----|-|---|-----------|---|---|-----|-|-|-|---|-+   |   |     | |   | | |   | |   | | | | |   |   | | ", " |         |         |                 | |   | |       | |                     |             | | |     | |   |   | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | | | | |   |   | | ", " |         |         |         +---------|---|-|-------|---------+             |             | | |     | |   | +---|---------|-|---------|---|-------------------------|-|-----|-|---|-|-+ | |   |   | | ", " |         |         |         |       | |   | |       | |       |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |         |     +-----------------------------|-----------+     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |         |     |   |         |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     +-----------+ | +-+     |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | | | | |     |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | | | | |     |       | |   | |       | | |     |             +-------------+ +-|-----------|-|---------+ | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     | +-----+ |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     |   | | | |     |   |     | |   | | |   | |   | |   | |   |   | | ", " |     |   |     | +-----|-------------|-|---|---------------------------------------+           |     | |   | | | |       | | | | +---|-----|-------------|-----|-----|-|-------|---------|-+   | +-|-+ ", " |     |   |     |   | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |       | | | | |   |   | | | |     |   |     | |   | | |   | |   | |   |     | | |   ", " |     |   |     | +-|---|-------------|-----|-|-----------|-------------------------|-----------|-------|---------|-----------|---|---------|-|-------|-----------|-------|---|-------------+   | | |   ", " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |       | | | | |   |   | | | |     |   |     | |   | | |   | |   | |   | |   | | |   ", " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |   +-----|---|-|-------------|-----|---|-----|---+ | | +---|-|---|-----------|---|-+ ", " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ", " | +-----------------|-|-|-------------|-|---+ |       | | |     |           +-------|-------+   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ", " | |   |   |     | | | | |     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ", " | |   |   |     | | | | |     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | +-----------------|-|-+ ", " | |   |   |     | | | | W     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     |     | |   | |   | | |   ", " | |   |   |     | | | | |     |       | |     |     +---|-------|-------------------|-+     |   |     | |   | | | |   |   | | | | |   | +-|-|-|-----------------|---|-+ +-----|---+ | |   | |   | | |   ", " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | | | |   |   | | | | |   | | | | | |     |   |     | | |         |   | | |   | |   | | |   ", " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | | +-----|-----|-----|-----|-|-|---+     |   |     | | | +-+     |   | | |   | |   | | |   ", " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | |   |   |   | | | | |   | | | | |       |   |     | | | | |     |   | | |   | |   | | |   ", " | |   |   |     | | | | |     |     +-|-|-----|-------|-|-----------------------------|---+ |   |     | |   | |   +---|---|-|-|-|-----|-|-|-|-|-----------|--R--|---+ | |     |   +-|-+   | |   | | |   ", " | |   |   |     | | | | |     |     | | |     |     | | | |     |           |       | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |     |     | |   | | |   ", " | |   +---------|-------------|---------------|-----|-|-|-------------------+       | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |   +-+ +---|---+ | | |   ", " | |       |     | | | | |     |     | | |     |     | | | |     |                   | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |   |   |   | | | | | |   ", " | |       |     | | | | |     |     | | |     |     | | | |     |                   +-|---------------|-|---|-|-------------|-|-|-----|-|-|-----------|---------+ |   | |     |   |   |   | | | | | |   ", " | |       |     | | | | |     |     | | |     |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |       |   | |     |   |   |   | | | | | |   ", " | |       |     | | | | |     |     | | +-----------------------|---------------------|---|-----|-----|-------|-------|---|-----|-----|---|-|---------|-+ |       |   | |     +---+   |   | | | | | |   ", " | |       |     | | | | |     |     | |       |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |       | | |       |   | |             |   | | | | | |   ", " | | +-----|---------|-----------------|-------|-----|-|---|-----|---------------------------|---|-------------|-----------------|-|-----------|-----+ | | |       |   | |             |   | | | | | |   ", " | | |     |     | | | | |     |     | |       |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     | | | |       |   | |             |   | | | | | |   ", " | | +---+ |     | | | | |     |     | +-----------+ | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     | +-|-|-----------|-|-------+ +-------|-|-----|---+ ", " | |     | |     | | | | |     |     |         |   | | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ", " +-|-------------|-|-|-|-------------|-------------|-------------|-------------------------|-----------|-----------------+ | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ", "   |     | |     | | | | |     |     |         |   | | | | |     |                     |   | |   |     | |   | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ", " +---+   | |     | | | | |     |     |         |   | | | | |     |                     +---------------|-+   | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ", " | | |   | |     | | | | |     |     |         |   | | | | |     |                         | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ", " | | |   | |   +---|-----|-----|-----|-+       |   | | | | |     |                     +-----|---|-----|-----|-------------|-----------|-|---|-------------|-------|-------------|-+   |   | | | | | | | ", " | | |   | |   | | | | | |     |     | |       |   | | | | |     |                     |   | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ", " | | |   | |   | | | | | |   +-+     | |       |   | | | | |     |                   +-+   | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ", " | | |   | |   | | | | | |   |       | |       |   | | | | |     |                   |     | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ", " +---|-----------|-|-|-|-----|-------|---------|---|-|-----|-------------------------|-----+ |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     | +-+ | | | | | | ", "   | |   | |   | | | | | |   |       | |       |   | | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     | |   | | | | | | ", "   | |   | |   | | | | +-----+       | |       |   +-|-----|-----|-------------------|-------|---------|-----|-------------|-------|-----|-----|-----|---|-------------+ |       |     | |   | | | | | | ", "   | |   | |   | | | |   |           | |       |     | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       E     |       |     | |   | | | | | | ", "   | |   | |   | | | |   |           +-|-------------------|-------------------------------------|-----------|-|-------|---|-|-|-------|-----|-|-----|---|---------|-----------+ |     | |   | | | | | | ", "   | |   | |   | | | |   |             |       |     | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       |     |     | |     | |   | | | | | | ", " +---------|---|-----------------------|-------------------|---------------------+   |       | +-|-----+     | |       | | | | | | |   | | | | |     |   | +-------|-----|-------|---+ | | +-----|-|---+ ", " | | |   | |   | | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | | | |   | | | | |     |   |         |     |     | |   | | | | | | | | |   ", " | | +---|-----+ | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | | +-----------|-|-----|-------------+     |     | |   | | | | | | | | |   ", " | |     | |     | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | |   ", " +-----+ | |     | | |   |             |       |     | | | |     |               |   |       | | |   +---------|-------|---|-|-----|---|-----|-|---------|-----------------------|-----|-|-|---|-|---|-+ ", "   |   | | |     | | |   |             |       |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ", "   |   +-|-----------|---|---------------+     |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ", "   |     | |     | | |   |             | |     |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ", " +---------------|-------|---------------|-+   |     | | | |   +-----------------------------|---|-+ |       | |       | | | | |   |   | | | | |     |   |               +-----|-|-+ | | | | | | | | | | ", " | |     | |     | | |   |             | | |   |     | | | |   | |               |   |       | | | | |       | |       | | | | |   |   | | | | |     |   |                     | | | | | | | | | | | | | ", " | |     | +-----|-------|---------------------|-------|---------|---------------------------|-|-----|-------|-----------|-+ +-----|---|---|---------|---|-+                   | | | | | | | | | | | | | ", " | |     |       | | |   |             | | |   |     | | | |   | |               |   |       | | | | |       | |       | |     |   |   | | | | |     |   | |                   | | | | | | | | | | | | | ", " | |     |       | | |   |             | | |   |     | | | +---------------------------------|-|-|-|-|---------|-------|-|-------------|-------|-----|---|---------------------------|---|-+ | | | | | | ", " | |     |       | | |   |             | | |   |     | | |     | |               |   |       | | | | |       | |       | |     |   |   | | | | |     |   | |                   | | | | | |   | | | | | | ", " +---+   |       | | |   |             | | |   |     | | |     | |               |   |   +---|-|-|-----------------------------|-------|---|-|-|-----|---|---------+           | | | | | |   | | | | | | ", "   | |   |       | | |   |             | | |   |     | | |     | |               |   |   |   | | | | |       | |       | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ", "   | |   | +-------|-------------------|-|-|---------------------|---------------------+ |   | | | +-|-------|-------+ | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ", "   | |   | |     | | |   |             | | |   |     | | |     | |               |   | | |   | | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ", "   +-------|-------|-----|-------------|---|---|-----|-----------|---------------|-----------+ | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | | +-+ | | ", "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ", "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ", "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ", " +---|-----|-----|---------------------|-|-------------|-------|-----------------|---|-|-|-------|-----------------------|-----|---|---+ | | | |     |   | |       |           | | | | | |   | |     | | ", " |   |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |     | | | |     |   | |       |           | | | | | |   | |     | | ", " |   |   | |     | | |   |             | | |   |     | +-|-------|---------------|-----|---+ +---|---|-------|-------|---|-----|---|-----|-+ | |     |   | |       |           | | | | | |   | |     | | ", " |   |   | |     | | |   |             | | |   |     |   |     | |               |   | | | | | | |   |       | |     | | |     |   |     |   | |     |   | |       |           | | | | | |   | |     | | ", " |   |   | |   +-----|-------------------|-|-------+ |   |     | |   +---------------|---|-|-|-|-----|-------|-------|---|-----|---|---------|-------------|-------------+   +-----|---|-|-+ | |     | | ", " |   |   | |   | | | |   |             | | |   |   | |   |     | |   |           |   | | | | | | |   |       | |     | | |     |   |     |   | |     |   | |       |     |   | | | | | | | | | |     | | ", " |   |   | |   | | | |   +-----------+ +---|-------|-+   |     | |   |           +---|-|-----|---------------|-------|---|---------|-----------------|---+ |     +-|-+   |   | | | | | | | | | |     | | ", " |   |   | |   | | | |               |   | |   |   |     |     | |   |               | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |   | | | | | | | | | |     | | ", " |   |   | |   | | | |               |   | |   |   | +---|-----------|-----------+   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |   +-|---|-----+ | | |     | | ", " |   |   | |   | | | |               |   | |   |   | |   |     | |   |           |   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ", " |   |   | |   | | | |               +---|-|---|---------|-----|-----------------+   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ", " |   |   | |   | | | |                   | |   |   | |   |     | |   |               | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ", " | +-|-+ | |   | | | |                   | +-------------------|-----------------------|-----|-|-|-------------|---+ | | | +---|---------------|-----------|-----|-------------|-----|-+   | | |     | | ", " | | | | | |   | | | |                   |     |   | |   |     | |   |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ", " | | | | | |   | | | |                   +-----|---------------|-+   |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ", " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ", " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ", " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ", " | | | | | |   | | | |                         |   | |   +-----|---------------------------|-|-|-----|-------+ |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | +-+   | | |     | | ", " | | | | | |   | | | |                         |   | |         |     |               | | | | | | |   |         |   | | | | |   |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ", " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | +-|-------------|-|-----+   |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ", " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ", " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ", " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ", " | | | | | |   | | | |                         |   | +---------|-----|---------------|-|-|-------|-----------------+ | | |     |   |     |   | |     |     |     | | +---|---+ | | | B +---|-|-|-+   | | ", " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   |     |   | |     |     |     | |     |   | | | | |     | | | |   | | ", " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   | +---+   | |     |     |     | |     |   | | | | +-+   | | | |   | | ", " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   | |       | |     |     |     | |     |   | | | |   |   | | | |   | | ", " | | | | | |   +-|-|-------------+             |   |           |     |               +-+ | +---|-|---|-------------+ | | |     |   | |       | |     |     |     | | +-------|-----|---|-+ | | | |   | | ", " | | | | | |     | | |           |             |   |           |     |                   |   | | | | |         |   | | | |     |   | |       | |     |     |     | | |   |   | | | |   | | | | | |   | | ", " | | | | | |     | | |           |             |   |   +-------+     |                   |   | | | | |       +-|---|---|-|-----------|---------------|---+ | +-------|-----------|-----|-|-------|-+ | | ", " | | | | | |     | | |           |             |   |   |             |                   |   | | | | |       | |   | | | |     |   | |       | |     |   | | |   | | |   |   | | | |   | | | | | | | | | ", " | | | | | |     | | |           |             |   |   |             |                   |   | | +-|-|-------|-|---|---|-|---------|-+       | |     |   +-|---+ | +-+   |   | | | +---+ +-+ | | | | | | ", " | | | | | |     | | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ", " | | +-|---|-----+ | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ", " | |   | | |       | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ", " | |   | | |       | |           +---------+   |   |   |             |           +---------------------------|-----|-|---|-----|---|---------|-|-------------------------|-----|---------+   | | | | | | ", " | |   | | |       | |                     |   |   |   |             |           |       |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ", " | |   | | |       | |                     |   |   |   +-------------+   +-------|-----------|-+   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ", " | |   | | |       | |                     |   |   |                     |       |       |   |     | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ", " +-+   | +-|-+     | +---+                 |   |   |                     |       |       |   |     | |       | +---|---+ |     |   |         | |     |   +-+ | +-|-------|---|-------------------+ | +-+ ", "       |   | |     |     |                 |   |   |                     |       |       |   |     | |       |     | |   |     |   |         | |     |   |   |   |       |   | | |       |   | |   |     ", "       |   | |     +---+ +-------------------------|---------------------|-------------------------|-|-------|-----|-----+     |   |         | |     |   |   |   |       |   | | |       |   | |   |     ", "       |   | |         |                   |   |   |                     |       |       |   |     | |       |     | |         |   |         | |     |   |   |   |       |   | | |       |   | |   |     ", "       |   +-----------------------+       | +-+   |               +-+   |       |       +---|-------|-------|-------|---------|---|---------|-|-----|-+ |   |   |       |   | | |       |   | |   |     ", "       |     |         |           |       | |     |               | |   |       |           |     | |       |     | |         |   |         | |     | | |   |   |       |   | | |       |   | |   |     ", "   +---------+         |           +-------|-----------------------+ +-----------------------|-----|-----------+   | |         |   +-----------|-----------------------+ |   | | |       |   | |   +---+ ", "   |   |               |                   | |     |                     |       |           |     | |       | |   | |         |             | |     | | |   |   |     | |   | | |       |   | |       | ", "   |   |               |                   | +--N------------------------|-------------------|-----+ |       | +---|-|-+       |             | |     | | |   |   |     | |   | | |       |   | |       | ", "   |   |               |                   |       |                     |       |           |       |       |     | | |       |             | |     | | |   |   |     | |   | | |       |   | |       | ", "   |   |               |         +-----------------|---------------+ +-----------|-----------+ +-------------|-----|---+       +-------------|-|-----|---|---+   |     | |   | | |       |   | |       | ", "   |   |               |         |         |       |               | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ", " +---------------------+         | +---------------+     +-----+   | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ", " | |   |                         | |       |             |     |   | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ", " | |   |                         | |       |             +-----|-----|---|-----------------------------------+     | |                       | |     | | |       |     | |   | | |       |   | |       | ", " | |   |                         | |       |                   |   | |   |       |             |     |             | |                       | |     | | |       |     | |   | | |       |   | |       | ", " +-|-----+                       +-+       |                   |   | +---|-------|-------------+     |             | |                       +-|--------L--------------+ |   | | |       |   | |       | ", "   |   | |                                 |                   |   |     |       |                   |             | |                         |     | | |       |       |   | | |       |   | |       | ", "   |   | |                                 |                   |   |     +---------------------------|---------------|-------------------------------+ | |       |       |   +---+       |   | |       | ", "   |   | |                                 |                   |   |             |                   |             | |                         |       | |       |       |     |         |   | |       | ", "   |   | |                                 |                   |   |             |                   +-----------------------------------------|-------|-----------------|---+ |         |   | | +---+ | ", "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ", "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ", "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ", "   |   | +---------------------------------|-----------------------|-------------------------------------------------+                         |       | |       |       |   | |         +-----|-----+ | ", "   |   |                                   |                   |   |             |                                 |                           |       | |       |       |   | |             | | |     | ", "   |   |             +---------------------------------------------+             |                                 |                           |       | |       |       |   +---------------+ +---+   | ", "   |   |             |                     |                   |                 |                                 |                           |       | |       |       |     |                 | |   | ", " +-+   |             |                     |                   |                 |                                 |                           |       | |       |     +-------------------------+ +---+ ", " |     |             |                     |                   |                 |                                 |                           |       | |       |     | |     |                         ", " |     +-------------------------------------------------------|-----------------|---------------------------------|---------------------------|-------|---------|-----+ |     |                         ", " |                   |                     |                   |                 |                                 |                           |       | |       |       |     |                         ", " |                   +-----------------------------------------+                 |         +-----------------------|---------------------------+       | |       |       |     |                         ", " |                                         |                                     |         |                       |                                   | |       |       |     |                         ", " |                                         |   +---------------------------------|-------------+                   |         +---------------------------+       |       |     |                         ", " |                                         |   |                                 |         |   |                   |         |                         |         |       |     |                         ", " +-----------------------------------------+   +---------------------------------|---------|-+ |                   |         +---------+               |         |       |     |                         ", "                                                                                 |         | | |                   |                   |               |         |       |     |                         ", " +--------Y----------------------------------------------------------------------|-----------|-|-------------------------------------------------------|---------|-------+     |                         ", " |                                                                               |         | | |                   |                   |               |         |             |                         ", " +-------------------------------------------------------------------------------+         +-+ +-------------------+                   +---------------+         +-------------+                         ", "                                                                                                                                                                                                         "];

let p37 = {
	problem: day19,
	
	tests: [
		{problem: ["     |          ", "     |  +--+    ", "     A  |  C    ", " F---|----E|--+ ", "     |  |  |  D ", "     +B-+  +--+ "], solution: "ABCDEF"}
	],

	solveFor: function(diagram) {
		let letters = "";
		let dir = [0, 1];
		let pos = [diagram[0].indexOf("|"), 0];
		do {
			pos = [pos[0] + dir[0], pos[1] + dir[1]];
			let curr = this.charAt(diagram, pos);
			if (curr != '|' && curr != '-' && curr != '+')
				letters += curr;
			dir = this.nextMove(diagram, pos, dir);
		} while(dir != null);
		
		return letters;
	},
	
	nextMove(diagram, pos, dir) {
		if (this.charAt(diagram, [pos[0] + dir[0], pos[1] + dir[1]]) != ' ')
			return dir;
		let cameFrom = [dir[0] * -1, dir[1] * -1];
		let dirs = [[1,0],[-1,0],[0,1],[0,-1]];
		for (let i = 0; i < 4; ++i)
			if ((dirs[i][0] != cameFrom[0] || dirs[i][1] != cameFrom[1])
				&& this.charAt(diagram, [pos[0] + dirs[i][0], pos[1] + dirs[i][1]]) != ' ')
				return dirs[i];
		return null;
	},
	
	charAt(diagram, pos) {
		if ((pos[0] < 0 || pos[0] >= diagram[0].length)
			|| (pos[1] < 0 || pos[1] >= diagram.length))
			return ' ';
		return diagram[pos[1]].charAt(pos[0]);
	}
};

let p38 = {
	problem: day19,
	
	tests: [
		{problem: ["     |          ", "     |  +--+    ", "     A  |  C    ", " F---|----E|--+ ", "     |  |  |  D ", "     +B-+  +--+ "], solution: 38}
	],

	solveFor: function(diagram) {
		let dir = [0, 1];
		let pos = [diagram[0].indexOf("|"), 0];
		let trailLen = 1;
		do {
			pos = [pos[0] + dir[0], pos[1] + dir[1]];
			dir = this.nextMove(diagram, pos, dir);
			++trailLen;
		} while(dir != null);
		
		return trailLen;
	},
	
	nextMove(diagram, pos, dir) {
		if (this.charAt(diagram, [pos[0] + dir[0], pos[1] + dir[1]]) != ' ')
			return dir;
		let cameFrom = [dir[0] * -1, dir[1] * -1];
		let dirs = [[1,0],[-1,0],[0,1],[0,-1]];
		for (let i = 0; i < 4; ++i)
			if ((dirs[i][0] != cameFrom[0] || dirs[i][1] != cameFrom[1])
				&& this.charAt(diagram, [pos[0] + dirs[i][0], pos[1] + dirs[i][1]]) != ' ')
				return dirs[i];
		return null;
	},
	
	charAt(diagram, pos) {
		if ((pos[0] < 0 || pos[0] >= diagram[0].length)
			|| (pos[1] < 0 || pos[1] >= diagram.length))
			return ' ';
		return diagram[pos[1]].charAt(pos[0]);
	}
};
